{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Continuous Compliance Evidence (CCE) Input Schema",
  "description": "Schema for CCE JSON payloads generated by the KSI_Engine.",
  "type": "object",
  "properties": {
    "asset_id": {
      "type": "string",
      "description": "The identifier of the affected asset.",
      "examples": ["arn:aws:s3:::sensitive-data-bucket"]
    },
    "severity": {
      "type": "string",
      "description": "The original severity of the finding.",
      "enum": ["Low", "Medium", "High", "Critical"]
    },
    "control_id": {
        "type": "string",
        "description": "The type of compliance finding (e.g., NIST control).",
        "examples": ["CM-6"]
    },
    "description": {
      "type": "string",
      "description": "A technical description of the compliance finding."
    },
    "tags": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Tags associated with the asset or finding for context.",
      "examples": [["CUI", "Production"]]
    },
    "mitigated": {
        "type": "boolean",
        "description": "Indicates if the risk has been mitigated."
    }
  },
  "required": ["asset_id", "severity", "control_id", "tags"]
}
