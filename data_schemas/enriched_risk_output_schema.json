{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Enriched Risk Output Schema",
  "description": "Schema for the enriched JSON payload sent to the Praetorium_Nexus API.",
  "type": "object",
  "properties": {
    "cce_finding_id": {
      "type": "string",
      "description": "The ID of the original CCE finding."
    },
    "original_severity": {
      "type": "string",
      "description": "The original severity from the CCE payload.",
      "enum": ["Low", "Medium", "High", "Critical"]
    },
    "refined_risk_score": {
      "type": "string",
      "description": "The new risk score after applying OPA policy.",
      "enum": ["Low", "Medium", "High", "Critical"]
    },
    "executive_summary": {
      "type": "string",
      "description": "A non-technical summary of the finding generated by an LLM."
    },
    "remediation_playbook": {
      "type": "string",
      "description": "A reference to an automated remediation playbook.",
      "examples": ["s3_public_access_fix.tf"]
    },
    "original_payload": {
      "type": "object",
      "description": "The original CCE payload for full context."
    }
  },
  "required": [
    "cce_finding_id",
    "original_severity",
    "refined_risk_score",
    "executive_summary",
    "remediation_playbook",
    "original_payload"
  ]
}
